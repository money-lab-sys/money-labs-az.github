<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#0f141f">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>1WIN | JETX PRO</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&family=Rajdhani:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- 1WIN PREMIUM STYLE --- */
        :root {
            --bg: #0f141f;
            --header: #19202e;
            --primary: #2196f3; /* 1Win Blue */
            --accent: #00c853; /* Success Green */
            --text: #ffffff;
            --text-gray: #7d8aa5;
            --border: rgba(255, 255, 255, 0.08);
            --input-bg: #1e2536;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; user-select: none; }
        
        body {
            margin: 0; padding: 0;
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Inter', sans-serif;
            height: 100vh; height: 100dvh;
            display: flex; flex-direction: column;
            overflow: hidden;
        }

        /* --- AUTH SCREEN (Gƒ∞Rƒ∞≈û) --- */
        #authScreen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 9999;
            background: radial-gradient(circle at top, #1c263b 0%, #0b0e14 100%);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            padding: 25px;
        }

        .logo-box { text-align: center; margin-bottom: 40px; }
        .logo-main { font-family: 'Rajdhani'; font-size: 52px; font-weight: 900; color: white; letter-spacing: -1px; }
        .logo-main span { color: var(--primary); }
        .logo-sub { color: var(--text-gray); font-size: 13px; letter-spacing: 3px; text-transform: uppercase; font-weight: 700; }

        .form-card {
            width: 100%; max-width: 360px;
            display: flex; flex-direction: column; gap: 15px;
        }

        .inp-wrap { position: relative; }
        .inp-icon { position: absolute; left: 16px; top: 50%; transform: translateY(-50%); color: var(--text-gray); font-size: 18px; }
        
        .win-input {
            width: 100%; padding: 18px 18px 18px 50px;
            background: var(--input-bg);
            border: 1px solid var(--border); border-radius: 12px;
            color: white; font-size: 15px; font-weight: 600;
            transition: 0.3s;
        }
        .win-input:focus { border-color: var(--primary); background: #252e42; }
        .win-input::placeholder { color: #556075; }

        /* PROMO KOD SAH∆èSƒ∞ √ú√á√úN X√úSUSƒ∞ STƒ∞L */
        #regCode { border: 1px solid #2196f3; box-shadow: 0 0 10px rgba(33, 150, 243, 0.1); }

        .btn-enter {
            width: 100%; padding: 20px;
            background: linear-gradient(90deg, #2196f3, #42a5f5);
            border: none; border-radius: 12px;
            color: white; font-weight: 800; font-size: 16px; text-transform: uppercase;
            box-shadow: 0 10px 30px rgba(33, 150, 243, 0.3);
            cursor: pointer; margin-top: 10px; transition: 0.2s;
        }
        .btn-enter:active { transform: scale(0.98); }

        .error-msg { color: #ff4d4d; font-size: 12px; text-align: center; min-height: 20px; font-weight: 600; margin-top: 10px; }

        /* --- APP INTERFACE --- */
        #appScreen { display: none; flex-direction: column; height: 100%; width: 100%; }

        /* HEADER */
        .win-header {
            height: 60px; display: flex; justify-content: space-between; align-items: center;
            padding: 0 15px; background: var(--header); border-bottom: 1px solid var(--border);
        }
        .h-logo { font-family: 'Rajdhani'; font-weight: 900; font-size: 24px; color: white; }
        .h-logo span { color: var(--primary); }
        
        .user-badge {
            display: flex; align-items: center; gap: 10px;
            background: rgba(255,255,255,0.05); padding: 6px 12px; border-radius: 8px; border: 1px solid var(--border);
        }
        .ub-icon { width: 28px; height: 28px; background: var(--primary); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-weight: bold; }
        .ub-bal { font-weight: 700; color: var(--accent); font-size: 14px; }

        /* GAME AREA */
        .game-stage {
            flex: 1; position: relative; overflow: hidden;
            background: radial-gradient(circle at 50% 100%, #1e2638 0%, #0f141f 70%);
        }
        canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }

        .center-hud {
            position: absolute; top: 40%; left: 50%; transform: translate(-50%, -50%);
            text-align: center; width: 100%; z-index: 10; pointer-events: none;
        }
        .big-multi {
            font-family: 'Rajdhani'; font-size: 72px; font-weight: 800; color: white;
            text-shadow: 0 0 40px rgba(33, 150, 243, 0.5);
        }
        .status-pill {
            display: inline-block; padding: 6px 14px; background: rgba(0,0,0,0.4);
            border-radius: 20px; font-size: 11px; font-weight: 700; color: var(--text-gray);
            margin-top: 10px; border: 1px solid rgba(255,255,255,0.1);
        }

        /* CONTROLS */
        .controls-panel {
            background: var(--header); padding: 15px;
            border-radius: 20px 20px 0 0; border-top: 1px solid var(--border);
            z-index: 20; box-shadow: 0 -10px 40px rgba(0,0,0,0.5);
        }

        .bet-box {
            display: flex; gap: 8px; margin-bottom: 12px; background: var(--input-bg);
            padding: 4px; border-radius: 10px; border: 1px solid var(--border);
        }
        .bet-btn-sm {
            width: 45px; height: 45px; background: rgba(255,255,255,0.05); border: none; border-radius: 8px;
            color: #ccc; font-size: 18px; cursor: pointer;
        }
        .bet-input-val {
            flex: 1; background: transparent; border: none; text-align: center;
            color: white; font-size: 20px; font-weight: 800; font-family: 'Rajdhani';
        }

        .action-btn {
            width: 100%; height: 56px; border-radius: 10px; border: none;
            font-size: 18px; font-weight: 800; text-transform: uppercase; cursor: pointer; color: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3); transition: 0.2s;
        }
        .btn-blue { background: linear-gradient(135deg, #2196f3, #1976d2); }
        .btn-green { background: linear-gradient(135deg, #00c853, #009624); display: none; }

        /* TABS */
        .info-area { height: 160px; background: #000; border-top: 1px solid #333; display: flex; flex-direction: column; }
        .tab-menu { display: flex; height: 36px; background: #151b26; }
        .tab-link {
            flex: 1; display: flex; align-items: center; justify-content: center;
            font-size: 10px; font-weight: 700; color: #5c6b85; cursor: pointer;
        }
        .tab-link.active { background: #000; color: var(--primary); border-top: 2px solid var(--primary); }
        
        .tab-body { flex: 1; padding: 10px; overflow-y: auto; display: none; }
        .tab-body.active { display: block; }

        /* Chat & Bets */
        .c-row { font-size: 11px; margin-bottom: 6px; }
        .c-u { color: #8fa0bc; font-weight: 700; margin-right: 5px; }
        .c-m { color: #dce4f0; }
        .l-row { display: flex; justify-content: space-between; font-size: 11px; padding: 4px 0; border-bottom: 1px solid #222; }

        /* ANIM */
        .crashed { color: #ff4d4d !important; text-shadow: 0 0 30px #ff4d4d !important; animation: shake 0.4s; }
        .won { color: #00c853 !important; text-shadow: 0 0 30px #00c853 !important; transform: scale(1.1); }
        @keyframes shake { 0%, 100% {transform: translate(-50%,-50%);} 25% {transform: translate(-52%, -48%);} 75% {transform: translate(-48%, -52%);} }
    </style>
</head>
<body>

    <script>
        // S∆èNƒ∞N GOOGLE SCRIPT Lƒ∞NKƒ∞N (API):
        const API_URL = "https://script.google.com/macros/s/AKfycbyPfZnIrtTM44QAxWZRFvcY2UrxN77gpDi4XxLqzq7EEv1GNCWZdaeEgNRLpAwnxlFlHA/exec";
    </script>

    <div id="authScreen">
        <div class="logo-box">
            <div class="logo-main">1WIN <span>JET</span></div>
            <div class="logo-sub">PREMIUM ACCESS ONLY</div>
        </div>

        <div class="form-card">
            <div class="inp-wrap">
                <i class="fa-regular fa-user inp-icon"></i>
                <input type="text" id="regName" class="win-input" placeholder="Ad v…ô Soyad" autocomplete="off">
            </div>
            <div class="inp-wrap">
                <i class="fa-regular fa-envelope inp-icon"></i>
                <input type="email" id="regEmail" class="win-input" placeholder="Email Adresi" autocomplete="off">
            </div>
            <div class="inp-wrap">
                <i class="fa-solid fa-ticket inp-icon" style="color:#2196f3;"></i>
                <input type="text" id="regCode" class="win-input" placeholder="PROMO KOD (M√ºtl…ôq)" style="border-color: #2196f3; box-shadow: 0 0 5px rgba(33,150,243,0.2);" autocomplete="off">
            </div>
            
            <button class="btn-enter" id="loginBtn" onclick="tryLogin()">OYUNA DAXƒ∞L OL</button>
            <div class="error-msg" id="errMsg"></div>
        </div>
    </div>

    <div id="appScreen">
        <div class="win-header">
            <div class="h-logo">1WIN <span>JET</span></div>
            <div class="user-badge">
                <div class="ub-icon" id="uInit">U</div>
                <div class="ub-bal">$<span id="uBal">0.00</span></div>
            </div>
        </div>

        <div class="game-stage" id="stage">
            <canvas id="stars"></canvas>
            <canvas id="game"></canvas>
            
            <div class="center-hud">
                <div class="big-multi" id="multi">1.00x</div>
                <div class="status-pill" id="status">M∆èRC Q∆èBUL OLUNUR</div>
            </div>
        </div>

        <div class="controls-panel">
            <div class="bet-box">
                <button class="bet-btn-sm" onclick="adjBet(-5)">-</button>
                <input type="number" id="betVal" class="bet-input-val" value="10" readonly>
                <button class="bet-btn-sm" onclick="adjBet(5)">+</button>
                <button class="bet-btn-sm" style="font-size:12px; width:60px; color:white; background:#2c3e50;" onclick="adjBet(50)">+50</button>
            </div>
            
            <button class="action-btn btn-blue" id="btnBet" onclick="play()">M∆èRC ET</button>
            <button class="action-btn btn-green" id="btnCash" onclick="cashOut()">PULU G√ñT√úR</button>
        </div>

        <div class="info-area">
            <div class="tab-menu">
                <div class="tab-link active" onclick="tab('chat')">CANLI √áAT</div>
                <div class="tab-link" onclick="tab('bets')">M∆èRCL∆èR</div>
            </div>
            <div id="tab-chat" class="tab-body active">
                <div class="c-row"><span class="c-u" style="color:#2196f3;">Sistem:</span> <span class="c-m">Xo≈ü g…ôlmisiniz! Uƒüurlar.</span></div>
            </div>
            <div id="tab-bets" class="tab-body">
                </div>
        </div>
    </div>

    <script>
        // --- LOGIC ---
        let user = { name: "", email: "", balance: 0.00 };
        let isPlaying = false;
        let multi = 1.00;
        let crashPoint = 0;
        let animId, startTime;

        // Auto Login (Yadda≈üda varsa birba≈üa gir)
        if(localStorage.getItem('win_u_final')) {
            user = JSON.parse(localStorage.getItem('win_u_final'));
            loadGameUI();
        }

        async function tryLogin() {
            let n = document.getElementById('regName').value.trim();
            let e = document.getElementById('regEmail').value.trim();
            let c = document.getElementById('regCode').value.trim();
            let err = document.getElementById('errMsg');
            let btn = document.getElementById('loginBtn');

            // Validasiya
            if(n.length < 3) { err.innerText = "Adƒ±nƒ±zƒ± tam yazƒ±n!"; return; }
            if(!e.includes('@')) { err.innerText = "Email d√ºzg√ºn deyil!"; return; }
            if(c.length < 2) { err.innerText = "Promo Kod m√ºtl…ôqdir!"; return; }

            btn.innerText = "YOXLANILIR...";
            btn.style.opacity = 0.7;
            err.innerText = "";

            try {
                // Kodla Giri≈ü Sorƒüusu (Backend yoxlayacaq v…ô DEAKTIV ed…ôc…ôk)
                let res = await fetch(`${API_URL}?action=login&name=${encodeURIComponent(n)}&email=${encodeURIComponent(e)}&code=${encodeURIComponent(c)}`);
                let data = await res.json();

                if(data.result === 'success') {
                    // Uƒüurlu Giri≈ü
                    user = { name: n, email: e, balance: parseFloat(data.balance) };
                    localStorage.setItem('win_u_final', JSON.stringify(user));
                    loadGameUI();
                } else {
                    // X…ôta (Kod s…ôhvdir v…ô ya i≈ül…ônib)
                    err.innerText = data.msg || "Kod yanlƒ±≈üdƒ±r v…ô ya i≈ül…ônib!";
                    btn.innerText = "OYUNA DAXƒ∞L OL";
                    btn.style.opacity = 1;
                }
            } catch(e) {
                err.innerText = "ƒ∞nternet x…ôtasƒ±. Yenid…ôn yoxlayƒ±n.";
                btn.innerText = "OYUNA DAXƒ∞L OL";
                btn.style.opacity = 1;
            }
        }

        function loadGameUI() {
            document.getElementById('authScreen').style.display = 'none';
            document.getElementById('appScreen').style.display = 'flex';
            document.getElementById('uInit').innerText = user.name[0].toUpperCase();
            updateBal();
            initCanvas();
            startSim();
        }

        function play() {
            let bet = parseInt(document.getElementById('betVal').value);
            if(user.balance < bet) return alert("Balansƒ±nƒ±z bitib! Yeni kod alƒ±n.");

            user.balance -= bet; updateBal();
            isPlaying = true; multi = 1.00;

            document.getElementById('btnBet').style.display = 'none';
            document.getElementById('btnCash').style.display = 'block';
            document.getElementById('multi').className = "big-multi";
            document.getElementById('multi').style.color = "white";
            document.getElementById('status').innerText = "RAKET U√áUR...";

            crashPoint = Math.random() < 0.4 ? 1.0 + Math.random()*0.3 : 1.5 + Math.random()*5;
            startTime = Date.now();
            loop();
        }

        function loop() {
            if(!isPlaying) return;
            let t = (Date.now() - startTime) / 1000;
            multi = 1.00 + (t*t*0.1);

            if(multi >= crashPoint) { crash(); return; }

            document.getElementById('multi').innerText = multi.toFixed(2) + "x";
            draw(t);
            animId = requestAnimationFrame(loop);
        }

        function cashOut() {
            if(!isPlaying) return;
            isPlaying = false; cancelAnimationFrame(animId);

            let bet = parseInt(document.getElementById('betVal').value);
            let win = bet * multi;
            user.balance += win; updateBal();
            
            // Udu≈üu server…ô yaz (Win Log)
            fetch(`${API_URL}?action=win&name=${user.name}&email=${user.email}&amount=${win.toFixed(2)}`, {mode:'no-cors'});

            document.getElementById('multi').classList.add('won');
            document.getElementById('status').innerText = `QAZANDINIZ: $${win.toFixed(0)}`;
            reset();
        }

        function crash() {
            isPlaying = false; cancelAnimationFrame(animId);
            document.getElementById('multi').innerText = multi.toFixed(2) + "x";
            document.getElementById('multi').classList.add('crashed');
            document.getElementById('status').innerText = "PARTLADI!";
            if(navigator.vibrate) navigator.vibrate(200);
            reset();
        }

        function reset() {
            localStorage.setItem('win_u_final', JSON.stringify(user));
            setTimeout(() => {
                document.getElementById('btnBet').style.display = 'block';
                document.getElementById('btnCash').style.display = 'none';
                document.getElementById('multi').className = "big-multi";
                document.getElementById('multi').innerText = "1.00x";
                document.getElementById('multi').style.color = "white";
                document.getElementById('status').innerText = "M∆èRC Q∆èBUL OLUNUR";
                initCanvas();
            }, 3000);
        }

        // --- VISUALS ---
        const cvs = document.getElementById('game');
        const ctx = cvs.getContext('2d');
        let w, h;

        function initCanvas() {
            w = cvs.width = document.getElementById('stage').offsetWidth;
            h = cvs.height = document.getElementById('stage').offsetHeight;
            ctx.clearRect(0,0,w,h);
            
            const sCtx = document.getElementById('stars').getContext('2d');
            document.getElementById('stars').width = w; document.getElementById('stars').height = h;
            sCtx.fillStyle = "rgba(255,255,255,0.2)"; sCtx.clearRect(0,0,w,h);
            for(let i=0; i<40; i++) { sCtx.beginPath(); sCtx.arc(Math.random()*w, Math.random()*h, Math.random()*2, 0, 6.28); sCtx.fill(); }
        }

        function draw(t) {
            ctx.clearRect(0,0,w,h);
            let x = Math.min(w - 60, t * 80);
            let y = h - Math.min(h - 60, (multi - 1) * 120);

            ctx.beginPath(); ctx.lineWidth = 6; ctx.strokeStyle = "#2196f3";
            ctx.shadowBlur = 20; ctx.shadowColor = "#2196f3";
            ctx.moveTo(0, h); ctx.quadraticCurveTo(x/2, h, x, y); ctx.stroke();
            ctx.shadowBlur = 0;

            ctx.save(); ctx.translate(x, y); ctx.rotate(-45 * Math.PI / 180);
            ctx.font = "30px Arial"; ctx.fillText("üöÄ", -15, 0); ctx.restore();
        }

        // --- UTILS ---
        function updateBal() { document.getElementById('uBal').innerText = user.balance.toFixed(2); }
        function adjBet(v) { let el = document.getElementById('betVal'); let val = parseInt(el.value)+v; if(val<1)val=1; el.value=val; }
        function tab(id) { 
            document.querySelectorAll('.tab-body').forEach(e=>e.classList.remove('active'));
            document.getElementById('tab-'+id).classList.add('active');
            document.querySelectorAll('.tab-link').forEach(e=>e.classList.remove('active'));
            event.target.classList.add('active');
        }
        
        // FAKE ACTIVITY
        function startSim() {
            setInterval(() => {
                if(Math.random()>0.5) {
                    let u = "Trader"+Math.floor(Math.random()*900);
                    let m = ["Uddum!", "Risk et!", "10x g…ôlir", "Salam"][Math.floor(Math.random()*4)];
                    let d = document.createElement('div'); d.className="c-row"; d.innerHTML=`<span class="c-u">${u}:</span> <span class="c-m">${m}</span>`;
                    document.getElementById('tab-chat').appendChild(d);
                }
            }, 3000);
        }
    </script>
</body>
</html>
