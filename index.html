<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#080a10">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>JETWIN | ELITE TRADING</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&family=Rajdhani:wght@600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- 1. CORE & RESET --- */
        :root {
            --bg: #080a10;
            --panel: rgba(22, 27, 34, 0.95);
            --primary: #3b82f6; /* Modern Blue */
            --accent: #60a5fa;
            --gold: #fbbf24;
            --green: #10b981;
            --red: #ef4444;
            --text: #f3f4f6;
            --text-mute: #9ca3af;
            --glass: rgba(255, 255, 255, 0.05);
            --border: rgba(255, 255, 255, 0.1);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; user-select: none; }
        
        body {
            margin: 0; padding: 0;
            background-color: var(--bg);
            background-image: radial-gradient(circle at 50% 0%, #1e293b 0%, var(--bg) 60%);
            color: var(--text);
            font-family: 'Inter', sans-serif;
            height: 100vh; height: 100dvh;
            overflow: hidden;
            display: flex; flex-direction: column;
        }

        /* --- 2. AUTH SCREEN (High-End Login) --- */
        #authScreen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 9999;
            background: #080a10;
            background-image: 
                radial-gradient(at 0% 0%, rgba(59, 130, 246, 0.15) 0px, transparent 50%),
                radial-gradient(at 100% 100%, rgba(16, 185, 129, 0.1) 0px, transparent 50%);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            padding: 30px; backdrop-filter: blur(10px);
        }

        .brand-logo {
            font-family: 'Rajdhani'; font-size: 48px; font-weight: 900; letter-spacing: -2px;
            background: linear-gradient(135deg, #fff 0%, #94a3b8 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            margin-bottom: 5px; text-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .brand-sub { font-size: 13px; color: var(--primary); letter-spacing: 3px; margin-bottom: 40px; text-transform: uppercase; font-weight: 700; }

        .auth-card {
            width: 100%; max-width: 340px;
            background: rgba(255,255,255,0.03);
            border: 1px solid var(--border);
            border-radius: 24px;
            padding: 30px 20px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .inp-group { position: relative; margin-bottom: 15px; }
        .inp-icon { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: var(--text-mute); font-size: 14px; }
        
        .nice-inp {
            width: 100%; padding: 16px 16px 16px 45px;
            background: rgba(0,0,0,0.2);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: white; font-size: 15px; transition: 0.3s;
        }
        .nice-inp:focus { border-color: var(--primary); background: rgba(59, 130, 246, 0.05); }

        .btn-glow {
            width: 100%; padding: 18px; margin-top: 10px;
            background: linear-gradient(135deg, var(--primary), #2563eb);
            border: none; border-radius: 12px;
            color: white; font-weight: 800; font-size: 16px; letter-spacing: 1px;
            cursor: pointer; position: relative; overflow: hidden;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.4);
            transition: transform 0.1s;
        }
        .btn-glow:active { transform: scale(0.98); }

        /* --- 3. MAIN APP LAYOUT --- */
        #appScreen { display: none; flex-direction: column; height: 100%; width: 100%; }

        /* HEADER */
        .app-header {
            height: 60px; display: flex; justify-content: space-between; align-items: center;
            padding: 0 20px; background: var(--panel);
            border-bottom: 1px solid var(--border);
            z-index: 100;
        }
        .user-pill {
            display: flex; align-items: center; gap: 10px;
            background: var(--glass); padding: 6px 12px; border-radius: 30px; border: 1px solid var(--border);
        }
        .u-avatar { width: 28px; height: 28px; background: linear-gradient(45deg, #475569, #1e293b); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; }
        .u-bal { font-family: 'Rajdhani'; font-weight: 700; color: var(--green); letter-spacing: 0.5px; }

        /* GAME STAGE */
        .stage {
            flex: 1; position: relative; overflow: hidden;
            background: radial-gradient(circle at 50% 120%, #1e293b 0%, #080a10 70%);
        }
        canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        
        .center-hud {
            position: absolute; top: 40%; left: 50%; transform: translate(-50%, -50%);
            text-align: center; z-index: 10; pointer-events: none; width: 100%;
        }
        .multiplier {
            font-family: 'Rajdhani'; font-size: 72px; font-weight: 800;
            background: linear-gradient(180deg, #fff 0%, #cbd5e1 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 0 20px rgba(59, 130, 246, 0.3));
            transition: 0.1s;
        }
        
        /* MOTIVATION TEXT STYLE */
        .moti-box {
            margin-top: 15px; min-height: 20px;
        }
        .moti-text {
            font-size: 13px; font-weight: 500; letter-spacing: 0.5px;
            color: var(--text-mute); text-transform: uppercase;
            opacity: 0; animation: fadeInUp 0.5s forwards;
        }

        /* CONTROLS AREA */
        .controls {
            background: var(--panel);
            padding: 20px 20px 10px 20px;
            border-radius: 24px 24px 0 0;
            border-top: 1px solid var(--border);
            box-shadow: 0 -10px 40px rgba(0,0,0,0.5);
            z-index: 50; position: relative;
        }
        
        .bet-input-row { display: flex; gap: 10px; margin-bottom: 15px; }
        
        .bet-adjuster {
            flex: 1; display: flex; align-items: center; justify-content: space-between;
            background: #0f172a; border: 1px solid var(--border); border-radius: 12px; padding: 4px;
        }
        .ba-btn {
            width: 40px; height: 40px; border-radius: 8px; border: none;
            background: rgba(255,255,255,0.05); color: white; font-size: 18px; cursor: pointer;
        }
        .ba-val {
            background: transparent; border: none; color: white;
            font-family: 'Rajdhani'; font-size: 22px; font-weight: 700; width: 60px; text-align: center;
        }

        .act-btn {
            width: 100%; height: 56px; border-radius: 12px; border: none;
            font-size: 18px; font-weight: 800; letter-spacing: 1px;
            text-transform: uppercase; cursor: pointer; color: white;
            transition: 0.2s; position: relative; overflow: hidden;
        }
        .btn-bet { background: linear-gradient(135deg, var(--primary), #2563eb); box-shadow: 0 4px 20px rgba(59, 130, 246, 0.4); }
        .btn-cash { background: linear-gradient(135deg, var(--gold), #d97706); color: #000; display: none; box-shadow: 0 4px 20px rgba(251, 191, 36, 0.4); }

        /* TABS & INFO PANEL */
        .info-panel {
            height: 180px; background: #020408;
            display: flex; flex-direction: column;
            border-top: 1px solid var(--border);
        }
        .tabs { display: flex; height: 40px; background: #0f172a; }
        .tab {
            flex: 1; display: flex; align-items: center; justify-content: center;
            font-size: 11px; font-weight: 700; color: var(--text-mute);
            cursor: pointer; border-bottom: 2px solid transparent; transition: 0.3s;
        }
        .tab.active { color: white; border-bottom: 2px solid var(--primary); background: rgba(59, 130, 246, 0.05); }

        .tab-content { flex: 1; overflow-y: auto; padding: 10px; display: none; }
        .tab-content.active { display: block; }
        /* Scrollbar hide */
        .tab-content::-webkit-scrollbar { width: 4px; }
        .tab-content::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }

        /* CHAT STYLES */
        .msg { margin-bottom: 8px; font-size: 12px; line-height: 1.4; animation: slideIn 0.3s; }
        .msg-name { font-weight: 700; color: var(--text-mute); margin-right: 6px; }
        .msg-txt { color: #e2e8f0; }
        .msg-sys { color: var(--gold); font-style: italic; opacity: 0.8; }

        /* LIVE BETS STYLES */
        .lb-row { display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid rgba(255,255,255,0.03); font-size: 11px; }
        .lb-name { color: #94a3b8; }
        .lb-bet { color: white; font-weight: 600; }
        .lb-win { color: var(--green); font-weight: 700; }

        /* ANIMATIONS */
        .crashed { color: var(--red) !important; text-shadow: 0 0 40px var(--red) !important; animation: shake 0.4s; }
        .won { color: var(--green) !important; text-shadow: 0 0 40px var(--green) !important; transform: scale(1.1); }
        
        @keyframes fadeInUp { from {opacity:0; transform:translateY(10px);} to {opacity:1; transform:translateY(0);} }
        @keyframes slideIn { from {opacity:0; transform:translateX(-10px);} to {opacity:1; transform:translateX(0);} }
        @keyframes shake { 0%, 100% {transform: translate(-50%,-50%);} 25% {transform: translate(-52%, -48%);} 75% {transform: translate(-48%, -52%);} }
    </style>
</head>
<body>

    <script>
        const API_URL = "https://script.google.com/macros/s/AKfycbziqHnM6kV-b_ZPLzvGEsoRsO_Emfl0qu-ab5AoNJLIdwqGVuLdPgkilzyAnK60JqbGmg/exec";
    </script>

    <div id="authScreen">
        <div class="brand-logo">JETWIN</div>
        <div class="brand-sub">FUTURE OF TRADING</div>
        
        <div class="auth-card">
            <div class="inp-group">
                <i class="fa-regular fa-user inp-icon"></i>
                <input type="text" id="regName" class="nice-inp" placeholder="ƒ∞stifad…ô√ßi Adƒ±" autocomplete="off">
            </div>
            <div class="inp-group">
                <i class="fa-regular fa-envelope inp-icon"></i>
                <input type="email" id="regEmail" class="nice-inp" placeholder="Email (Qazanc √º√ß√ºn)" autocomplete="off">
            </div>
            <button class="btn-glow" id="authBtn" onclick="handleAuth()">
                <i class="fa-solid fa-rocket" style="margin-right:8px;"></i> Sƒ∞STEM∆è Gƒ∞Rƒ∞≈û
            </button>
            <p id="statusMsg" style="text-align:center; color:#64748b; font-size:11px; margin-top:15px; min-height:15px;"></p>
        </div>
    </div>

    <div id="appScreen">
        <div class="app-header">
            <div class="user-pill">
                <div class="u-avatar" id="uAv">U</div>
                <div style="display:flex; flex-direction:column; line-height:1;">
                    <span style="font-size:10px; color:#94a3b8;" id="uNameDisp">User</span>
                    <span class="u-bal">$<span id="balance">0.00</span></span>
                </div>
            </div>
            <div onclick="openPromo()" style="width:32px; height:32px; background:rgba(251,191,36,0.1); border-radius:50%; display:flex; align-items:center; justify-content:center; color:var(--gold); cursor:pointer;">
                <i class="fa-solid fa-gift"></i>
            </div>
        </div>

        <div class="stage" id="stage">
            <canvas id="stars"></canvas>
            <canvas id="game"></canvas>
            
            <div class="center-hud">
                <div class="multiplier" id="multi">1.00x</div>
                <div class="moti-box">
                    <div class="moti-text" id="motiText">Professional Trading</div>
                </div>
            </div>
        </div>

        <div class="controls">
            <div class="bet-input-row">
                <div class="bet-adjuster">
                    <button class="ba-btn" onclick="adjBet(-5)">-</button>
                    <input type="number" id="betVal" class="ba-val" value="10" readonly>
                    <button class="ba-btn" onclick="adjBet(5)">+</button>
                </div>
                <button class="ba-btn" style="width:auto; padding:0 15px; font-size:12px; font-weight:bold; background:#1e293b;" onclick="adjBet(50)">+50</button>
            </div>
            
            <button class="act-btn btn-bet" id="btnBet" onclick="playGame()">M∆èRC ET</button>
            <button class="act-btn btn-cash" id="btnCash" onclick="cashOut()">PULU G√ñT√úR</button>
        </div>

        <div class="info-panel">
            <div class="tabs">
                <div class="tab active" onclick="setTab('chat')"><i class="fa-regular fa-comments" style="margin-right:5px;"></i> CANLI √áAT</div>
                <div class="tab" onclick="setTab('bets')"><i class="fa-solid fa-list-ol" style="margin-right:5px;"></i> M∆èRCL∆èR</div>
            </div>
            
            <div id="tab-chat" class="tab-content active">
                <div class="msg"><span class="msg-sys">Sistem:</span> Xo≈ü g…ôlmisiniz! Qazanmaƒüa ba≈ülayƒ±n.</div>
            </div>
            
            <div id="tab-bets" class="tab-content">
                </div>
        </div>
    </div>

    <script>
        // --- CONFIG & STATE ---
        let user = { name: "Guest", email: "", balance: 0.00 };
        let isPlaying = false;
        let multi = 1.00;
        let crashPoint = 0;
        let startTime, animFrame;
        
        // Motivasiya Kitabxanasƒ±
        const ph_Win = ["M√∂ht…ô≈ü…ôm N…ôtic…ô!", "Professional Yana≈üma!", "S…ôn Bu ƒ∞≈üi Bilirs…ôn!", "Milyon√ßu Zehniyy…ôti!", "Dayanma, U√ßu≈üdasan!"];
        const ph_Lose = ["T…ôcr√ºb…ô Qazandƒ±n.", "N√∂vb…ôti Raund S…ônindir.", "Risk Yoxsa, Qazanc Yoxdur.", "Fokusunu ƒ∞tirm…ô.", "S…ôbrli Ol."];
        const ph_Idle = ["F√ºrs…ôti G√∂zl…ô...", "Strategiyanƒ± Qur.", "Hazƒ±rsan?", "B√∂y√ºk Oyna."];

        // S…ôs Sintezi (Audio Engine) - Faylsƒ±z s…ôs
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        const ctxAudio = new AudioContext();
        
        function sfx(type) {
            if(ctxAudio.state === 'suspended') ctxAudio.resume();
            const osc = ctxAudio.createOscillator();
            const gain = ctxAudio.createGain();
            osc.connect(gain); gain.connect(ctxAudio.destination);
            const now = ctxAudio.currentTime;

            if(type==='click') {
                osc.frequency.setValueAtTime(600, now); gain.gain.setValueAtTime(0.05, now);
                osc.start(now); osc.stop(now+0.05);
            }
            if(type==='win') {
                osc.type = 'triangle';
                osc.frequency.setValueAtTime(400, now); osc.frequency.linearRampToValueAtTime(800, now+0.2);
                gain.gain.setValueAtTime(0.1, now); gain.gain.linearRampToValueAtTime(0, now+0.3);
                osc.start(now); osc.stop(now+0.3);
            }
            if(type==='crash') {
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(100, now); osc.frequency.linearRampToValueAtTime(20, now+0.3);
                gain.gain.setValueAtTime(0.2, now); gain.gain.linearRampToValueAtTime(0, now+0.3);
                osc.start(now); osc.stop(now+0.3);
            }
        }

        // --- AUTH & GOOGLE SYNC ---
        // Avto-Giri≈ü yoxlanƒ±≈üƒ±
        if(localStorage.getItem('jetwin_user')) {
            const saved = JSON.parse(localStorage.getItem('jetwin_user'));
            initApp(saved.name, saved.email, saved.balance);
        }

        async function handleAuth() {
            sfx('click');
            const n = document.getElementById('regName').value.trim();
            const e = document.getElementById('regEmail').value.trim();
            const status = document.getElementById('statusMsg');
            const btn = document.getElementById('authBtn');

            if(n.length < 3 || !e.includes('@')) {
                status.innerText = "‚ö†Ô∏è M…ôlumatlarƒ± d√ºzg√ºn daxil edin"; return;
            }

            status.innerText = "Serverl…ô …ôlaq…ô qurulur...";
            status.style.color = "#3b82f6";
            btn.style.opacity = "0.7"; btn.innerText = "Y√úKL∆èNƒ∞R...";

            try {
                // Fetch to Google Script
                const res = await fetch(`${API_URL}?action=register&name=${encodeURIComponent(n)}&email=${encodeURIComponent(e)}`);
                const data = await res.json();

                if(data.result === 'success') {
                    initApp(n, e, data.balance);
                } else {
                    throw new Error("API Error");
                }
            } catch(err) {
                // Fallback (Offline Mode or CORS issue protection)
                console.log("Offline or CORS fallback used");
                initApp(n, e, 50); // Bonus 50 for offline
            }
        }

        function initApp(name, email, bal) {
            user = { name: name, email: email, balance: parseFloat(bal) };
            localStorage.setItem('jetwin_user', JSON.stringify(user));

            document.getElementById('authScreen').style.display = 'none';
            document.getElementById('appScreen').style.display = 'flex';
            
            document.getElementById('uNameDisp').innerText = name;
            document.getElementById('uAv').innerText = name.charAt(0).toUpperCase();
            updateUI();
            
            initCanvas();
            animateBackground();
            startSimulation(); // Chat & Bets bots
        }

        // --- GAME ENGINE ---
        function playGame() {
            let bet = parseInt(document.getElementById('betVal').value);
            if(user.balance < bet) return alert("Balansƒ±nƒ±z kifay…ôt etmir!");

            sfx('click');
            user.balance -= bet; updateUI();
            
            isPlaying = true; multi = 1.00;
            
            // UI Update
            document.getElementById('btnBet').style.display = 'none';
            document.getElementById('btnCash').style.display = 'block';
            document.getElementById('multi').className = "multiplier";
            document.getElementById('multi').style.color = "white";
            setMoti("Raket Qalxƒ±r...", "#fff");
            
            // Algorithm
            crashPoint = (Math.random() < 0.4) ? (1.0 + Math.random()*0.3) : (1.5 + Math.random()*5);
            
            startTime = Date.now();
            loop();
        }

        function loop() {
            if(!isPlaying) return;
            let t = (Date.now() - startTime) / 1000;
            multi = 1.00 + (t * t * 0.1); // Exponential curve

            if(multi >= crashPoint) { crash(); return; }

            document.getElementById('multi').innerText = multi.toFixed(2) + "x";
            drawRocket(t);
            animFrame = requestAnimationFrame(loop);
        }

        function cashOut() {
            if(!isPlaying) return;
            isPlaying = false; cancelAnimationFrame(animFrame);
            sfx('win');

            let bet = parseInt(document.getElementById('betVal').value);
            let win = bet * multi;
            user.balance += win; updateUI();
            saveLocal();

            // SEND WIN TO GOOGLE SHEET (Background Sync)
            fetch(`${API_URL}?action=win&name=${user.name}&email=${user.email}&amount=${win.toFixed(2)}`, {mode: 'no-cors'});

            document.getElementById('multi').classList.add('won');
            setMoti(ph_Win[Math.floor(Math.random()*ph_Win.length)], "#10b981");
            
            resetGame();
        }

        function crash() {
            isPlaying = false; cancelAnimationFrame(animFrame);
            sfx('crash');

            document.getElementById('multi').innerText = multi.toFixed(2) + "x";
            document.getElementById('multi').classList.add('crashed');
            setMoti(ph_Lose[Math.floor(Math.random()*ph_Lose.length)], "#ef4444");

            if(navigator.vibrate) navigator.vibrate([100, 50, 100]);
            resetGame();
        }

        function resetGame() {
            setTimeout(() => {
                document.getElementById('btnBet').style.display = 'block';
                document.getElementById('btnCash').style.display = 'none';
                document.getElementById('multi').className = "multiplier";
                document.getElementById('multi').style.color = "white";
                document.getElementById('multi').innerText = "1.00x";
                setMoti(ph_Idle[Math.floor(Math.random()*ph_Idle.length)], "#9ca3af");
                initCanvas(); // Clear graph
            }, 3000);
        }

        // --- GRAPHICS & CANVAS ---
        const cvs = document.getElementById('game');
        const ctx = cvs.getContext('2d');
        const starCvs = document.getElementById('stars');
        const starCtx = starCvs.getContext('2d');
        let w, h;

        function initCanvas() {
            w = cvs.width = starCvs.width = document.getElementById('stage').offsetWidth;
            h = cvs.height = starCvs.height = document.getElementById('stage').offsetHeight;
            ctx.clearRect(0,0,w,h);
            drawStars();
        }
        window.addEventListener('resize', initCanvas);

        function drawRocket(t) {
            ctx.clearRect(0,0,w,h);
            let x = Math.min(w - 60, t * 80);
            let y = h - Math.min(h - 60, (multi - 1) * 120);

            // Line with Glow
            ctx.beginPath();
            ctx.lineWidth = 5;
            ctx.strokeStyle = "#3b82f6";
            ctx.shadowBlur = 20;
            ctx.shadowColor = "#3b82f6";
            ctx.moveTo(0, h);
            ctx.quadraticCurveTo(x/2, h, x, y);
            ctx.stroke();
            ctx.shadowBlur = 0; // Reset

            // Rocket Icon
            ctx.save();
            ctx.translate(x, y);
            ctx.rotate(-45 * Math.PI / 180);
            ctx.font = "32px Arial";
            ctx.fillText("üöÄ", -15, 0);
            ctx.restore();
        }

        function drawStars() {
            starCtx.fillStyle = "rgba(255,255,255,0.4)";
            for(let i=0; i<40; i++) {
                starCtx.beginPath();
                starCtx.arc(Math.random()*w, Math.random()*h, Math.random()*2, 0, Math.PI*2);
                starCtx.fill();
            }
        }
        
        function animateBackground() {
            // Subtle movement for stars can be added here
            requestAnimationFrame(animateBackground);
        }

        // --- SIMULATION (BOTS & CHAT) ---
        const botNames = ["Ali_Trade", "Elvin99", "BakuShark", "Tural.M", "Leyla_W", "Cavid.Pro", "Samir.Boss"];
        const botMsgs = ["Salam u≈üaqlar", "10x g…ôlir!", "Risk etdim", "Yes! Uddum!", "Gecikdim :(", "Admin salam", "Bu g√ºn yax≈üƒ± gedir"];

        function startSimulation() {
            // Chat Loop
            setInterval(() => {
                if(Math.random() > 0.4) return;
                let b = botNames[Math.floor(Math.random()*botNames.length)];
                let m = botMsgs[Math.floor(Math.random()*botMsgs.length)];
                addChat(b, m);
            }, 3500);

            // Bets Loop
            setInterval(() => {
                addFakeBet();
            }, 2000);
        }

        function addChat(n, m) {
            let div = document.createElement('div');
            div.className = "msg";
            div.innerHTML = `<span class="msg-name">${n}:</span><span class="msg-txt">${m}</span>`;
            let c = document.getElementById('tab-chat');
            c.appendChild(div);
            c.scrollTop = c.scrollHeight;
        }

        function addFakeBet() {
            let b = botNames[Math.floor(Math.random()*botNames.length)];
            let val = (10 + Math.random()*200).toFixed(0);
            let div = document.createElement('div');
            div.className = "lb-row";
            div.innerHTML = `<span class="lb-name">${b}</span><span class="lb-bet">$${val}</span><span class="lb-win">Pending</span>`;
            
            let list = document.getElementById('tab-bets');
            list.insertBefore(div, list.firstChild);
            if(list.children.length > 10) list.removeChild(list.lastChild);
            
            // Simulate win after delay
            setTimeout(() => {
                div.querySelector('.lb-win').innerText = "+$"+(val * (1+Math.random())).toFixed(0);
            }, 1000 + Math.random()*3000);
        }

        // --- UTILITIES ---
        function updateUI() { document.getElementById('balance').innerText = user.balance.toFixed(2); }
        function saveLocal() { localStorage.setItem('jetwin_user', JSON.stringify(user)); }
        function adjBet(v) { 
            sfx('click');
            let el = document.getElementById('betVal'); 
            let val = parseInt(el.value) + v;
            if(val < 1) val = 1; el.value = val;
        }
        function setMoti(txt, color) {
            let m = document.getElementById('motiText');
            m.style.animation = 'none';
            m.offsetHeight; /* trigger reflow */
            m.style.animation = 'fadeInUp 0.5s forwards';
            m.innerText = txt;
            m.style.color = color;
        }
        function setTab(id) {
            sfx('click');
            document.querySelectorAll('.tab-content').forEach(e=>e.classList.remove('active'));
            document.getElementById('tab-'+id).classList.add('active');
            document.querySelectorAll('.tab').forEach(e=>e.classList.remove('active'));
            event.currentTarget.classList.add('active');
        }
        
        async function openPromo() {
            sfx('click');
            let code = prompt("Promo Kodu Daxil Edin:");
            if(!code) return;
            try {
                let res = await fetch(`${API_URL}?action=promo&code=${encodeURIComponent(code)}`);
                let data = await res.json();
                if(data.result === 'success') {
                    sfx('win');
                    let amt = parseFloat(data.amount);
                    user.balance += amt; updateUI(); saveLocal();
                    alert(`‚úÖ T…ôbrikl…ôr! +$${amt} bonus qazandƒ±nƒ±z.`);
                    // Sync win
                    fetch(`${API_URL}?action=win&name=${user.name}&email=${user.email}&amount=${amt}`, {mode: 'no-cors'});
                } else {
                    alert("‚ùå Kod yanlƒ±≈üdƒ±r");
                }
            } catch(e) { alert("X…ôta ba≈ü verdi"); }
        }

    </script>
</body>
</html>
